<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CPR Screen Buyback Management System</title>
    
    <!-- React and ReactDOM from CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX transformation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
                'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
                sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #dc2626;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #b91c1c;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Lucide Icons as inline SVG components
        const LogIn = ({ size = 24, ...props }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4" />
                <polyline points="10 17 15 12 10 7" />
                <line x1="15" y1="12" x2="3" y2="12" />
            </svg>
        );

        const LogOut = ({ size = 24, ...props }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
                <polyline points="16 17 21 12 16 7" />
                <line x1="21" y1="12" x2="9" y2="12" />
            </svg>
        );

        const Plus = ({ size = 24, ...props }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <line x1="12" y1="5" x2="12" y2="19" />
                <line x1="5" y1="12" x2="19" y2="12" />
            </svg>
        );

        const Edit2 = ({ size = 24, ...props }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z" />
            </svg>
        );

        const Trash2 = ({ size = 24, ...props }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <polyline points="3 6 5 6 21 6" />
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" />
                <line x1="10" y1="11" x2="10" y2="17" />
                <line x1="14" y1="11" x2="14" y2="17" />
            </svg>
        );

        const Save = ({ size = 24, ...props }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z" />
                <polyline points="17 21 17 13 7 13 7 21" />
                <polyline points="7 3 7 8 15 8" />
            </svg>
        );

        const TrendingUp = ({ size = 24, ...props }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <polyline points="23 6 13.5 15.5 8.5 10.5 1 18" />
                <polyline points="17 6 23 6 23 12" />
            </svg>
        );

        const Package = ({ size = 24, ...props }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <line x1="16.5" y1="9.4" x2="7.5" y2="4.21" />
                <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z" />
                <polyline points="3.27 6.96 12 12.01 20.73 6.96" />
                <line x1="12" y1="22.08" x2="12" y2="12" />
            </svg>
        );

        const Settings = ({ size = 24, ...props }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <circle cx="12" cy="12" r="3" />
                <path d="M12 1v6m0 6v6m5.66-13.66l-4.24 4.24m-2.83 2.83l-4.24 4.24M23 12h-6m-6 0H1m16.24-5.66l-4.24 4.24m-2.83 2.83l-4.24 4.24" />
            </svg>
        );

        const UserPlus = ({ size = 24, ...props }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                <circle cx="8.5" cy="7" r="4" />
                <line x1="20" y1="8" x2="20" y2="14" />
                <line x1="23" y1="11" x2="17" y2="11" />
            </svg>
        );

        const Search = ({ size = 24, ...props }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <circle cx="11" cy="11" r="8" />
                <line x1="21" y1="21" x2="16.65" y2="16.65" />
            </svg>
        );

        const Copy = ({ size = 24, ...props }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2" />
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
            </svg>
        );

        const Download = ({ size = 24, ...props }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                <polyline points="7 10 12 15 17 10" />
                <line x1="12" y1="15" x2="12" y2="3" />
            </svg>
        );

        const BarChart3 = ({ size = 24, ...props }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <line x1="12" y1="20" x2="12" y2="10" />
                <line x1="18" y1="20" x2="18" y2="4" />
                <line x1="6" y1="20" x2="6" y2="16" />
            </svg>
        );

        const DollarSign = ({ size = 24, ...props }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <line x1="12" y1="1" x2="12" y2="23" />
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" />
            </svg>
        );

        const Users = ({ size = 24, ...props }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                <circle cx="9" cy="7" r="4" />
                <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
                <path d="M16 3.13a4 4 0 0 1 0 7.75" />
            </svg>
        );

        const CheckCircle = ({ size = 24, ...props }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" />
                <polyline points="22 4 12 14.01 9 11.01" />
            </svg>
        );

        // Simple localStorage-based storage system
        const createStorage = () => {
            return {
                get: async (key, shared = false) => {
                    try {
                        const value = localStorage.getItem(key);
                        if (value) {
                            return { key, value, shared };
                        }
                        return null;
                    } catch (e) {
                        return null;
                    }
                },
                set: async (key, value, shared = false) => {
                    try {
                        localStorage.setItem(key, value);
                        return { key, value, shared };
                    } catch (e) {
                        return null;
                    }
                }
            };
        };

        // Make storage available globally
        if (!window.storage) {
            window.storage = createStorage();
        }

        const BuybackSystem = () => {
            const [isAuthenticated, setIsAuthenticated] = useState(false);
            const [currentUser, setCurrentUser] = useState(null);
            const [screen, setScreen] = useState('login');
            const [loginUsername, setLoginUsername] = useState('');
            const [loginPassword, setLoginPassword] = useState('');
            const [loginError, setLoginError] = useState('');
            
            const [users, setUsers] = useState([]);
            const [batches, setBatches] = useState([]);
            const [models, setModels] = useState([]);
            const [suppliers, setSuppliers] = useState([]);
            const [prices, setPrices] = useState({});
            const [currentBatch, setCurrentBatch] = useState(null);
            const [isLoading, setIsLoading] = useState(true);
            
            const [showRegister, setShowRegister] = useState(false);
            const [regName, setRegName] = useState('');
            const [regUsername, setRegUsername] = useState('');
            const [regPassword, setRegPassword] = useState('');
            const [regError, setRegError] = useState('');
            
            const [settingsTab, setSettingsTab] = useState('prices');
            const [editPrices, setEditPrices] = useState({});
            const [editModels, setEditModels] = useState([]);
            const [editSuppliers, setEditSuppliers] = useState([]);
            const [newModel, setNewModel] = useState('');
            const [newSupplierName, setNewSupplierName] = useState('');
            const [isSaving, setIsSaving] = useState(false);
            const [searchTerm, setSearchTerm] = useState('');
            
            const [editingSupplier, setEditingSupplier] = useState(null);
            const [editSupplierName, setEditSupplierName] = useState('');

            useEffect(() => {
                loadData();
            }, []);

            const loadData = async () => {
                const defaultUsers = [{id:'1',name:'Admin',username:'admin',password:'admin123',role:'admin',createdAt:new Date().toISOString()}];
                const defaultModels = ["iPhone 16 Pro Max","iPhone 16 Pro","iPhone 16 Plus","iPhone 16","iPhone 15 Pro Max","iPhone 15 Pro","iPhone 15 Plus","iPhone 15"];
                const defaultSuppliers = [{name:"Mobile Sentrix",qualities:["OEM/Refurb","Aftermarket"]},{name:"Phone LCD Parts",qualities:["OEM/Refurb","Aftermarket"]},{name:"Injured Gadgets",qualities:["OEM/Refurb","Aftermarket"]}];

                setUsers(defaultUsers);
                setModels(defaultModels);
                setSuppliers(defaultSuppliers);
                setBatches([]);
                setPrices({});
                
                setTimeout(async()=>{
                    try{const d=await window.storage.get('users',true);if(d)setUsers(JSON.parse(d.value))}catch(e){}
                    try{const d=await window.storage.get('batches',true);if(d)setBatches(JSON.parse(d.value))}catch(e){}
                    try{const d=await window.storage.get('models',true);if(d)setModels(JSON.parse(d.value))}catch(e){}
                    try{const d=await window.storage.get('suppliers',true);if(d)setSuppliers(JSON.parse(d.value))}catch(e){}
                    try{const d=await window.storage.get('prices',true);if(d)setPrices(JSON.parse(d.value))}catch(e){}
                },100);
                
                setIsLoading(false);
            };

            useEffect(()=>{setEditPrices(prices);setEditModels(models);setEditSuppliers(suppliers)},[prices,models,suppliers]);

            const handleLogin=()=>{
                if(!loginUsername.trim()||!loginPassword.trim()){setLoginError('Please enter username and password');return;}
                const user=users.find(u=>u.username===loginUsername&&u.password===loginPassword);
                if(user){setCurrentUser(user);setIsAuthenticated(true);setScreen('dashboard');setLoginError('');setLoginUsername('');setLoginPassword('');}else{setLoginError('Invalid username or password');}
            };

            const handleRegister=async()=>{
                if(!regName.trim()||!regUsername.trim()||!regPassword.trim()){setRegError('All fields are required');return;}
                if(users.find(u=>u.username===regUsername)){setRegError('Username already exists');return;}
                if(regPassword.length<6){setRegError('Password must be at least 6 characters');return;}
                const newUser={id:Date.now().toString(),name:regName,username:regUsername,password:regPassword,role:'user',createdAt:new Date().toISOString()};
                const updatedUsers=[...users,newUser];
                setUsers(updatedUsers);
                await window.storage.set('users',JSON.stringify(updatedUsers),true);
                alert('Account created successfully!');
                setShowRegister(false);setRegName('');setRegUsername('');setRegPassword('');setRegError('');
            };

            const saveBatches=async(newBatches)=>{try{await window.storage.set('batches',JSON.stringify(newBatches),true);setBatches(newBatches)}catch(error){console.error('Error:',error)}};

            const createNewBatch=()=>{
                const bn=`B${new Date().getFullYear()}-${String(batches.length+1).padStart(3,'0')}`;
                const nb={id:Date.now().toString(),batchNumber:bn,createdBy:currentUser.name,createdById:currentUser.id,createdAt:new Date().toISOString(),inventory:models.map(m=>({model:m,oem:0,aftermarket:0})),analysis:null};
                setCurrentBatch(nb);setScreen('editor');
            };

            const editBatch=(batch)=>{setCurrentBatch(batch);setScreen('editor')};
            const duplicateBatch=(batch)=>{const bn=`B${new Date().getFullYear()}-${String(batches.length+1).padStart(3,'0')}`;const inv=batch.inventory.map(i=>({model:i.model,oem:i.oem||0,aftermarket:i.aftermarket||0}));const nb={...batch,id:Date.now().toString(),batchNumber:bn,createdBy:currentUser.name,createdById:currentUser.id,createdAt:new Date().toISOString(),inventory:inv,analysis:null};setCurrentBatch(nb);setScreen('editor')};
            const saveBatch=async()=>{if(!currentBatch)return;const bs={...currentBatch,updatedAt:new Date().toISOString(),updatedBy:currentUser.name};const idx=batches.findIndex(b=>b.id===currentBatch.id);let nb;if(idx>=0){nb=[...batches];nb[idx]=bs}else{nb=[...batches,bs]}await saveBatches(nb);alert('Batch saved successfully!');setScreen('dashboard')};
            const deleteBatch=async(batchId)=>{if(!confirm('Delete?'))return;await saveBatches(batches.filter(b=>b.id!==batchId))};

            const runAnalysis=()=>{
                if(!currentBatch)return;
                let opt=0;const alloc={};const tots={};
                suppliers.forEach(s=>{tots[s.name]=0;alloc[s.name]=[]});
                currentBatch.inventory.forEach(item=>{
                    ['OEM/Refurb','Aftermarket'].forEach(q=>{
                        const qty=q==='OEM/Refurb'?item.oem:item.aftermarket;
                        if(qty>0){
                            let bp=0,bs='';
                            suppliers.forEach(sup=>{const pk=`${item.model}_${sup.name}_${q}`;const pr=prices[pk]||0;if(pr>bp){bp=pr;bs=sup.name}});
                            opt+=bp*qty;
                            if(bs){alloc[bs].push({model:item.model,quality:q,quantity:qty,price:bp,total:bp*qty});tots[bs]+=bp*qty}
                        }
                    })
                });
                setCurrentBatch({...currentBatch,analysis:{optimalRevenue:opt,supplierAllocations:alloc,supplierTotals:tots,analyzedAt:new Date().toISOString()}})
            };

            const updateQuantity=(idx,field,value)=>{const inv=[...currentBatch.inventory];inv[idx][field]=parseInt(value)||0;setCurrentBatch({...currentBatch,inventory:inv})};
            const calculateLiveTotal=()=>{if(!currentBatch)return 0;let t=0;currentBatch.inventory.forEach(item=>{['OEM/Refurb','Aftermarket'].forEach(q=>{const qty=q==='OEM/Refurb'?item.oem:item.aftermarket;if(qty>0){let bp=0;suppliers.forEach(sup=>{const pk=`${item.model}_${sup.name}_${q}`;const pr=prices[pk]||0;if(pr>bp)bp=pr});t+=bp*qty}})});return t};

            const savePrices=async()=>{setIsSaving(true);try{await window.storage.set('prices',JSON.stringify(editPrices),true);setPrices(editPrices);alert('Prices saved!')}catch(e){alert('Error')}setIsSaving(false)};
            const saveModels=async()=>{setIsSaving(true);try{await window.storage.set('models',JSON.stringify(editModels),true);setModels(editModels);alert('Models saved!')}catch(e){alert('Error')}setIsSaving(false)};
            const saveSuppliers=async()=>{setIsSaving(true);try{await window.storage.set('suppliers',JSON.stringify(editSuppliers),true);setSuppliers(editSuppliers);alert('Suppliers saved!')}catch(e){alert('Error')}setIsSaving(false)};

            const addModel=()=>{if(!newModel.trim())return alert('Enter model name');if(editModels.includes(newModel.trim()))return alert('Model already exists');setEditModels([...editModels,newModel.trim()]);setNewModel('')};
            const removeModel=(model)=>{if(!confirm(`Remove ${model}?`))return;setEditModels(editModels.filter(m=>m!==model))};
            const addSupplier=()=>{if(!newSupplierName.trim())return alert('Enter supplier name');if(editSuppliers.find(s=>s.name===newSupplierName.trim()))return alert('Supplier exists');setEditSuppliers([...editSuppliers,{name:newSupplierName.trim(),qualities:['OEM/Refurb','Aftermarket']}]);setNewSupplierName('')};
            const removeSupplier=(supplierName)=>{if(!confirm(`Remove ${supplierName}?`))return;setEditSuppliers(editSuppliers.filter(s=>s.name!==supplierName))};
            
            const startEditingSupplier=(supplier)=>{setEditingSupplier(supplier.name);setEditSupplierName(supplier.name)};
            const saveSupplierNameEdit=async()=>{
                if(!editSupplierName.trim())return alert('Cannot be empty');
                if(editSuppliers.find(s=>s.name===editSupplierName.trim()&&s.name!==editingSupplier))return alert('Name exists');
                const us=editSuppliers.map(s=>s.name===editingSupplier?{...s,name:editSupplierName.trim()}:s);
                const up={...editPrices};
                Object.keys(up).forEach(k=>{if(k.includes(`_${editingSupplier}_`)){const nk=k.replace(`_${editingSupplier}_`,`_${editSupplierName.trim()}_`);up[nk]=up[k];delete up[k]}});
                setEditSuppliers(us);setEditPrices(up);setEditingSupplier(null);setEditSupplierName('');
                await window.storage.set('suppliers',JSON.stringify(us),true);await window.storage.set('prices',JSON.stringify(up),true);setSuppliers(us);setPrices(up);alert('Supplier name updated!')
            };

            const updatePrice=(model,supplier,quality,value)=>{const key=`${model}_${supplier}_${quality}`;setEditPrices({...editPrices,[key]:parseFloat(value)||0})};
            const exportBatch=(batch)=>{const d=JSON.stringify(batch,null,2);const blob=new Blob([d],{type:'application/json'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=`${batch.batchNumber}.json`;document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(url)};
            const filteredBatches=batches.filter(batch=>batch.batchNumber.toLowerCase().includes(searchTerm.toLowerCase())||batch.createdBy.toLowerCase().includes(searchTerm.toLowerCase()));
            const getDashboardStats=()=>{const totalBatches=batches.length;const analyzedBatches=batches.filter(b=>b.analysis).length;const totalRevenue=batches.reduce((sum,b)=>sum+(b.analysis?.optimalRevenue||0),0);const recentBatches=batches.slice(-5).reverse();return{totalBatches,analyzedBatches,totalRevenue,recentBatches}};

            if(!isAuthenticated){
                return(
                    <div className="min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex items-center justify-center p-4">
                        <div className="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md border-t-4 border-red-600">
                            {!showRegister?(
                                <>
                                    <div className="text-center mb-8">
                                        <div className="w-20 h-20 bg-red-600 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg">
                                            <span className="text-white font-bold text-2xl">CPR</span>
                                        </div>
                                        <h1 className="text-3xl font-bold text-gray-800">CPR Buyback</h1>
                                        <p className="text-gray-600 mt-2">Screen Buyback Management</p>
                                    </div>
                                    <div className="space-y-4">
                                        <input type="text" value={loginUsername} onChange={e=>setLoginUsername(e.target.value)} placeholder="Username" className="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-red-500" onKeyPress={e=>e.key==='Enter'&&handleLogin()}/>
                                        <input type="password" value={loginPassword} onChange={e=>setLoginPassword(e.target.value)} placeholder="Password" className="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-red-500" onKeyPress={e=>e.key==='Enter'&&handleLogin()}/>
                                        {loginError&&<div className="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm">{loginError}</div>}
                                        <button onClick={handleLogin} className="w-full bg-red-600 hover:bg-red-700 text-white font-semibold py-3 rounded-lg flex items-center justify-center gap-2"><LogIn size={20}/>Login</button>
                                        <button onClick={()=>setShowRegister(true)} className="w-full text-red-600 font-medium flex items-center justify-center gap-2 pt-4 border-t"><UserPlus size={18}/>Create New Account</button>
                                        <div className="bg-gray-50 p-3 rounded-lg text-xs text-center"><strong>Demo:</strong> admin / admin123</div>
                                    </div>
                                </>
                            ):(
                                <>
                                    <div className="text-center mb-6"><h2 className="text-2xl font-bold">Create Account</h2></div>
                                    <div className="space-y-4">
                                        <input type="text" value={regName} onChange={e=>setRegName(e.target.value)} placeholder="Full Name" className="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-red-500"/>
                                        <input type="text" value={regUsername} onChange={e=>setRegUsername(e.target.value)} placeholder="Username" className="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-red-500"/>
                                        <input type="password" value={regPassword} onChange={e=>setRegPassword(e.target.value)} placeholder="Password (min 6 chars)" className="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-red-500"/>
                                        {regError&&<div className="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm">{regError}</div>}
                                        <div className="flex gap-3">
                                            <button onClick={()=>setShowRegister(false)} className="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-3 rounded-lg">Cancel</button>
                                            <button onClick={handleRegister} className="flex-1 bg-red-600 hover:bg-red-700 text-white py-3 rounded-lg">Register</button>
                                        </div>
                                    </div>
                                </>
                            )}
                        </div>
                    </div>
                );
            }

            if(isLoading){
                return(
                    <div className="min-h-screen bg-gray-50 flex items-center justify-center">
                        <div className="text-center">
                            <div className="w-20 h-20 bg-red-600 rounded-full flex items-center justify-center mx-auto mb-4"><span className="text-white font-bold text-2xl">CPR</span></div>
                            <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto mb-4"></div>
                            <p className="text-gray-600">Loading...</p>
                        </div>
                    </div>
                );
            }

            if (screen === 'dashboard') {
                const stats = getDashboardStats();
                return (
                    <div className="min-h-screen bg-gray-50">
                        <div className="bg-white shadow border-b">
                            <div className="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
                                <div className="flex items-center gap-3">
                                    <div className="w-12 h-12 bg-red-600 rounded-full flex items-center justify-center">
                                        <span className="text-white font-bold">CPR</span>
                                    </div>
                                    <div>
                                        <h1 className="text-2xl font-bold">Dashboard</h1>
                                        <p className="text-sm text-gray-600">Welcome, <span className="text-red-600 font-semibold">{currentUser.name}</span></p>
                                    </div>
                                </div>
                                <button onClick={() => { setIsAuthenticated(false); setCurrentUser(null); setScreen('login'); }} className="flex items-center gap-2 px-4 py-2 hover:bg-gray-100 rounded-lg">
                                    <LogOut size={18} />Logout
                                </button>
                            </div>
                        </div>
                        <div className="max-w-7xl mx-auto px-4 py-6">
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                                <div className="bg-white rounded-xl shadow p-6 border-l-4 border-red-600">
                                    <div className="flex justify-between">
                                        <div>
                                            <p className="text-sm text-gray-600">Total Batches</p>
                                            <p className="text-3xl font-bold">{stats.totalBatches}</p>
                                        </div>
                                        <Package className="text-red-600" size={40} />
                                    </div>
                                </div>
                                <div className="bg-white rounded-xl shadow p-6 border-l-4 border-green-600">
                                    <div className="flex justify-between">
                                        <div>
                                            <p className="text-sm text-gray-600">Analyzed</p>
                                            <p className="text-3xl font-bold">{stats.analyzedBatches}</p>
                                        </div>
                                        <BarChart3 className="text-green-600" size={40} />
                                    </div>
                                </div>
                                <div className="bg-white rounded-xl shadow p-6 border-l-4 border-blue-600">
                                    <div className="flex justify-between">
                                        <div>
                                            <p className="text-sm text-gray-600">Revenue</p>
                                            <p className="text-3xl font-bold">${stats.totalRevenue.toFixed(2)}</p>
                                        </div>
                                        <DollarSign className="text-blue-600" size={40} />
                                    </div>
                                </div>
                            </div>
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                                <button onClick={createNewBatch} className="bg-red-600 hover:bg-red-700 text-white p-6 rounded-xl shadow flex items-center gap-3">
                                    <Plus size={24} /><span className="font-semibold">New Batch</span>
                                </button>
                                <button onClick={() => setScreen('list')} className="bg-white hover:bg-gray-50 p-6 rounded-xl shadow flex items-center gap-3 border-2">
                                    <Package size={24} className="text-red-600" /><span className="font-semibold">All Batches</span>
                                </button>
                                <button onClick={() => setScreen('settings')} className="bg-white hover:bg-gray-50 p-6 rounded-xl shadow flex items-center gap-3 border-2">
                                    <Settings size={24} className="text-red-600" /><span className="font-semibold">Settings</span>
                                </button>
                                <button onClick={() => setScreen('users')} className="bg-white hover:bg-gray-50 p-6 rounded-xl shadow flex items-center gap-3 border-2">
                                    <Users size={24} className="text-red-600" /><span className="font-semibold">Users</span>
                                </button>
                            </div>
                            <div className="bg-white rounded-xl shadow p-6">
                                <h2 className="text-xl font-bold mb-4">Recent Batches</h2>
                                {stats.recentBatches.length === 0 ? (
                                    <div className="text-center py-12">
                                        <Package className="mx-auto mb-4 text-gray-400" size={48} />
                                        <p className="text-gray-500">No batches yet</p>
                                    </div>
                                ) : (
                                    <div className="space-y-3">
                                        {stats.recentBatches.map(batch => (
                                            <div key={batch.id} className="flex justify-between p-4 bg-gray-50 rounded-lg hover:bg-red-50">
                                                <div>
                                                    <p className="font-semibold text-red-600">{batch.batchNumber}</p>
                                                    <p className="text-sm text-gray-600">By {batch.createdBy} • {new Date(batch.createdAt).toLocaleDateString()}</p>
                                                </div>
                                                <div className="flex gap-2 items-center">
                                                    {batch.analysis && <span className="text-sm font-semibold text-green-600">${batch.analysis.optimalRevenue.toFixed(2)}</span>}
                                                    <button onClick={() => editBatch(batch)} className="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg text-sm">View</button>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                );
            }

            if (screen === 'list') {
                return (
                    <div className="min-h-screen bg-gray-50">
                        <div className="bg-white shadow border-b">
                            <div className="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
                                <div className="flex items-center gap-3">
                                    <div className="w-12 h-12 bg-red-600 rounded-full flex items-center justify-center">
                                        <span className="text-white font-bold">CPR</span>
                                    </div>
                                    <div>
                                        <h1 className="text-2xl font-bold">All Batches</h1>
                                        <p className="text-sm text-gray-600">{filteredBatches.length} batches</p>
                                    </div>
                                </div>
                                <button onClick={() => setScreen('dashboard')} className="px-4 py-2 hover:bg-gray-100 rounded-lg">Back</button>
                            </div>
                        </div>
                        <div className="max-w-7xl mx-auto px-4 py-6">
                            <div className="flex gap-4 mb-6">
                                <div className="flex-1 relative">
                                    <Search className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400" size={20} />
                                    <input type="text" value={searchTerm} onChange={e => setSearchTerm(e.target.value)} placeholder="Search..." className="w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-red-500" />
                                </div>
                                <button onClick={createNewBatch} className="flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-semibold">
                                    <Plus size={20} />New Batch
                                </button>
                            </div>
                            {filteredBatches.length === 0 ? (
                                <div className="bg-white rounded-xl shadow p-12 text-center border-t-4 border-red-600">
                                    <Package className="mx-auto text-gray-400 mb-4" size={48} />
                                    <h3 className="text-xl font-semibold">No batches found</h3>
                                </div>
                            ) : (
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                    {filteredBatches.map(batch => (
                                        <div key={batch.id} className="bg-white rounded-xl shadow p-6 border-t-4 border-red-600 hover:shadow-lg">
                                            <div className="flex justify-between mb-4">
                                                <div>
                                                    <h3 className="text-lg font-bold text-red-600">{batch.batchNumber}</h3>
                                                    <p className="text-sm text-gray-600">By {batch.createdBy}</p>
                                                </div>
                                                {batch.analysis && <CheckCircle className="text-green-600" size={24} />}
                                            </div>
                                            <div className="mb-4 space-y-2">
                                                <div className="flex justify-between text-sm">
                                                    <span className="text-gray-600">Created:</span>
                                                    <span>{new Date(batch.createdAt).toLocaleDateString()}</span>
                                                </div>
                                                {batch.analysis && (
                                                    <div className="flex justify-between text-sm">
                                                        <span className="text-gray-600">Revenue:</span>
                                                        <span className="font-bold text-green-600">${batch.analysis.optimalRevenue.toFixed(2)}</span>
                                                    </div>
                                                )}
                                            </div>
                                            <div className="flex gap-2">
                                                <button onClick={() => editBatch(batch)} className="flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg text-sm">
                                                    <Edit2 size={16} />Edit
                                                </button>
                                                <button onClick={() => duplicateBatch(batch)} className="px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded-lg">
                                                    <Copy size={16} />
                                                </button>
                                                <button onClick={() => deleteBatch(batch.id)} className="px-4 py-2 bg-gray-200 hover:bg-red-100 text-gray-700 hover:text-red-600 rounded-lg">
                                                    <Trash2 size={16} />
                                                </button>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>
                    </div>
                );
            }

            if (screen === 'editor' && currentBatch) {
                const live = calculateLiveTotal();
                return (
                    <div className="min-h-screen bg-gray-50">
                        <div className="bg-white shadow border-b">
                            <div className="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
                                <div className="flex items-center gap-3">
                                    <div className="w-12 h-12 bg-red-600 rounded-full flex items-center justify-center">
                                        <span className="text-white font-bold">CPR</span>
                                    </div>
                                    <div>
                                        <h1 className="text-2xl font-bold">{currentBatch.batchNumber}</h1>
                                        <p className="text-sm">By <span className="text-red-600 font-semibold">{currentBatch.createdBy}</span></p>
                                    </div>
                                </div>
                                <div className="text-right">
                                    <p className="text-sm text-gray-600">Live Total</p>
                                    <p className="text-2xl font-bold text-blue-600">${live.toFixed(2)}</p>
                                </div>
                            </div>
                        </div>
                        <div className="max-w-7xl mx-auto px-4 py-6">
                            <div className="flex gap-3 mb-6">
                                <button onClick={() => setScreen('dashboard')} className="px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg">Back</button>
                                <button onClick={runAnalysis} className="flex items-center gap-2 px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-semibold">
                                    <TrendingUp size={18} />Run Analysis
                                </button>
                                <button onClick={saveBatch} className="flex items-center gap-2 px-6 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold">
                                    <Save size={18} />Save
                                </button>
                                {currentBatch.analysis && (
                                    <button onClick={() => exportBatch(currentBatch)} className="flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg">
                                        <Download size={18} />Export
                                    </button>
                                )}
                            </div>
                            <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                                <div className="lg:col-span-2 bg-white rounded-xl shadow p-6 border-t-4 border-red-600">
                                    <h2 className="text-xl font-bold mb-4">Inventory Input</h2>
                                    <p className="text-sm text-gray-600 mb-4">Enter quantities - we'll find best supplier!</p>
                                    <div className="overflow-auto" style={{ maxHeight: '70vh' }}>
                                        <table className="w-full text-sm">
                                            <thead className="bg-gray-50 sticky top-0">
                                                <tr>
                                                    <th className="px-4 py-3 text-left">Model</th>
                                                    <th className="px-4 py-3 text-center text-red-600">OEM/Refurb</th>
                                                    <th className="px-4 py-3 text-center text-red-600">Aftermarket</th>
                                                    <th className="px-4 py-3 text-center">Total</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {currentBatch.inventory.map((item, idx) => {
                                                    const oq = item.oem || 0;
                                                    const aq = item.aftermarket || 0;
                                                    let ob = 0;
                                                    let ab = 0;
                                                    suppliers.forEach(sup => {
                                                        const op = prices[`${item.model}_${sup.name}_OEM/Refurb`] || 0;
                                                        const ap = prices[`${item.model}_${sup.name}_Aftermarket`] || 0;
                                                        if (op > ob) ob = op;
                                                        if (ap > ab) ab = ap;
                                                    });
                                                    const rt = (ob * oq) + (ab * aq);
                                                    return (
                                                        <tr key={idx} className="border-t hover:bg-red-50">
                                                            <td className="px-4 py-3 font-medium">{item.model}</td>
                                                            <td className="px-4 py-3">
                                                                <div className="flex flex-col items-center gap-1">
                                                                    <input type="number" min="0" value={oq} onChange={e => updateQuantity(idx, 'oem', e.target.value)} className="w-24 px-3 py-2 border rounded-lg text-center focus:ring-2 focus:ring-red-500" />
                                                                    {oq > 0 && <div className="text-xs text-green-600 font-semibold">${ob.toFixed(2)} × {oq} = ${(ob * oq).toFixed(2)}</div>}
                                                                </div>
                                                            </td>
                                                            <td className="px-4 py-3">
                                                                <div className="flex flex-col items-center gap-1">
                                                                    <input type="number" min="0" value={aq} onChange={e => updateQuantity(idx, 'aftermarket', e.target.value)} className="w-24 px-3 py-2 border rounded-lg text-center focus:ring-2 focus:ring-red-500" />
                                                                    {aq > 0 && <div className="text-xs text-green-600 font-semibold">${ab.toFixed(2)} × {aq} = ${(ab * aq).toFixed(2)}</div>}
                                                                </div>
                                                            </td>
                                                            <td className="px-4 py-3 text-center">{rt > 0 && <span className="font-bold text-blue-600">${rt.toFixed(2)}</span>}</td>
                                                        </tr>
                                                    );
                                                })}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <div className="bg-white rounded-xl shadow p-6 border-t-4 border-red-600">
                                    <h2 className="text-xl font-bold mb-4">Analysis</h2>
                                    {currentBatch.analysis ? (
                                        <div className="space-y-4">
                                            <div className="bg-green-50 border-l-4 border-green-600 p-4 rounded">
                                                <p className="text-sm text-green-800 font-medium">Optimal Revenue</p>
                                                <p className="text-3xl font-bold text-green-700">${currentBatch.analysis.optimalRevenue.toFixed(2)}</p>
                                            </div>
                                            <div>
                                                <h3 className="font-semibold mb-3">Supplier Breakdown</h3>
                                                {Object.entries(currentBatch.analysis.supplierTotals).filter(([_, t]) => t > 0).sort((a, b) => b[1] - a[1]).map(([sup, tot]) => {
                                                    const itms = currentBatch.analysis.supplierAllocations[sup] || [];
                                                    return (
                                                        <div key={sup} className="mb-4 p-3 bg-gray-50 rounded border">
                                                            <div className="flex justify-between mb-2">
                                                                <span className="font-semibold">{sup}</span>
                                                                <span className="font-bold text-red-600">${tot.toFixed(2)}</span>
                                                            </div>
                                                            {itms.map((it, i) => (
                                                                <div key={i} className="text-xs text-gray-600 flex justify-between">
                                                                    <span>{it.model} ({it.quality})</span>
                                                                    <span>{it.quantity}×${it.price.toFixed(2)}</span>
                                                                </div>
                                                            ))}
                                                        </div>
                                                    );
                                                })}
                                            </div>
                                            <div className="bg-blue-50 p-4 rounded text-center">
                                                <CheckCircle className="mx-auto mb-2 text-blue-600" size={32} />
                                                <p className="text-sm font-semibold text-blue-800">Complete</p>
                                            </div>
                                        </div>
                                    ) : (
                                        <div className="text-center py-12">
                                            <TrendingUp className="mx-auto mb-4 text-gray-400" size={48} />
                                            <p className="text-gray-500">Run analysis</p>
                                        </div>
                                    )}
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            if (screen === 'settings') {
                return (
                    <div className="min-h-screen bg-gray-50">
                        <div className="bg-white shadow border-b">
                            <div className="max-w-7xl mx-auto px-4 py-4">
                                <h1 className="text-2xl font-bold">Settings</h1>
                            </div>
                        </div>
                        <div className="max-w-7xl mx-auto px-4 py-6">
                            <button onClick={() => setScreen('dashboard')} className="px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg mb-6">Back</button>
                            <div className="bg-white rounded-t-xl shadow border-b">
                                <div className="flex gap-2 p-2">
                                    <button onClick={() => setSettingsTab('prices')} className={`flex-1 py-3 px-4 rounded-lg font-semibold ${settingsTab === 'prices' ? 'bg-red-600 text-white' : 'bg-gray-100 hover:bg-gray-200'}`}>💰 Prices</button>
                                    <button onClick={() => setSettingsTab('models')} className={`flex-1 py-3 px-4 rounded-lg font-semibold ${settingsTab === 'models' ? 'bg-red-600 text-white' : 'bg-gray-100 hover:bg-gray-200'}`}>📱 Models</button>
                                    <button onClick={() => setSettingsTab('suppliers')} className={`flex-1 py-3 px-4 rounded-lg font-semibold ${settingsTab === 'suppliers' ? 'bg-red-600 text-white' : 'bg-gray-100 hover:bg-gray-200'}`}>🏢 Suppliers</button>
                                </div>
                            </div>
                            {settingsTab === 'prices' && (
                                <div className="bg-white rounded-b-xl shadow p-6">
                                    <div className="flex justify-between mb-4">
                                        <h2 className="text-xl font-bold">Prices</h2>
                                        <button onClick={savePrices} disabled={isSaving} className="px-6 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold disabled:opacity-50">{isSaving ? 'Saving...' : 'Save'}</button>
                                    </div>
                                    <div className="overflow-auto" style={{ maxHeight: '600px' }}>
                                        <table className="w-full text-sm">
                                            <thead className="bg-gray-50 sticky top-0">
                                                <tr>
                                                    <th className="px-4 py-3 text-left sticky left-0 bg-gray-50">Model</th>
                                                    {editSuppliers.map(sup => <th key={sup.name} colSpan={2} className="px-4 py-3 text-center border-l">{sup.name}</th>)}
                                                </tr>
                                                <tr className="bg-gray-100">
                                                    <th className="sticky left-0 bg-gray-100"></th>
                                                    {editSuppliers.map(sup => sup.qualities.map(q => <th key={`${sup.name}_${q}`} className="px-2 py-2 text-xs text-red-600">{q}</th>))}
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {editModels.map((mod, i) => (
                                                    <tr key={i} className="border-t hover:bg-red-50">
                                                        <td className="px-4 py-2 font-medium sticky left-0 bg-white">{mod}</td>
                                                        {editSuppliers.map(sup => sup.qualities.map(q => {
                                                            const k = `${mod}_${sup.name}_${q}`;
                                                            return (
                                                                <td key={k} className="px-2 py-2 text-center">
                                                                    <input type="number" min="0" step="0.01" value={editPrices[k] || 0} onChange={e => updatePrice(mod, sup.name, q, e.target.value)} className="w-20 px-2 py-1 border rounded text-center focus:ring-2 focus:ring-red-500" />
                                                                </td>
                                                            );
                                                        }))}
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            )}
                            {settingsTab === 'models' && (
                                <div className="bg-white rounded-b-xl shadow p-6">
                                    <h2 className="text-xl font-bold mb-4">Models</h2>
                                    <div className="flex gap-3 mb-6">
                                        <input type="text" value={newModel} onChange={e => setNewModel(e.target.value)} placeholder="iPhone 17 Pro Max" className="flex-1 px-4 py-2 border rounded-lg focus:ring-2 focus:ring-red-500" onKeyPress={e => e.key === 'Enter' && addModel()} />
                                        <button onClick={addModel} className="px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-semibold">Add</button>
                                    </div>
                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mb-6">
                                        {editModels.map((mod, i) => (
                                            <div key={i} className="flex justify-between items-center p-3 bg-gray-50 rounded border">
                                                <span className="font-medium">{mod}</span>
                                                <button onClick={() => removeModel(mod)} className="text-red-600"><Trash2 size={16} /></button>
                                            </div>
                                        ))}
                                    </div>
                                    <button onClick={saveModels} disabled={isSaving} className="px-6 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold disabled:opacity-50">{isSaving ? 'Saving...' : 'Save'}</button>
                                </div>
                            )}
                            {settingsTab === 'suppliers' && (
                                <div className="bg-white rounded-b-xl shadow p-6">
                                    <h2 className="text-xl font-bold mb-4">Suppliers</h2>
                                    <div className="flex gap-3 mb-6">
                                        <input type="text" value={newSupplierName} onChange={e => setNewSupplierName(e.target.value)} placeholder="Supplier name" className="flex-1 px-4 py-2 border rounded-lg focus:ring-2 focus:ring-red-500" onKeyPress={e => e.key === 'Enter' && addSupplier()} />
                                        <button onClick={addSupplier} className="px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-semibold">Add</button>
                                    </div>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                                        {editSuppliers.map((sup, i) => {
                                            const isEditing = editingSupplier === sup.name;
                                            return (
                                                <div key={i} className="p-4 bg-gray-50 rounded border">
                                                    <div className="flex justify-between items-start">
                                                        <div className="flex-1">
                                                            {isEditing ? (
                                                                <div className="flex gap-2">
                                                                    <input type="text" value={editSupplierName} onChange={e => setEditSupplierName(e.target.value)} className="flex-1 px-3 py-1 border-2 border-red-500 rounded-lg" autoFocus />
                                                                    <button onClick={saveSupplierNameEdit} className="px-3 py-1 bg-green-600 text-white rounded-lg text-sm font-bold">✓</button>
                                                                    <button onClick={() => { setEditingSupplier(null); setEditSupplierName(''); }} className="px-3 py-1 bg-gray-600 text-white rounded-lg text-sm font-bold">✕</button>
                                                                </div>
                                                            ) : (
                                                                <div>
                                                                    <h3 className="font-bold text-lg">{sup.name}</h3>
                                                                    <p className="text-sm text-gray-600">OEM/Refurb, Aftermarket</p>
                                                                </div>
                                                            )}
                                                        </div>
                                                        {!editingSupplier && (
                                                            <div className="flex gap-2">
                                                                <button onClick={() => startEditingSupplier(sup)} className="text-blue-600 hover:text-blue-800" title="Edit name">
                                                                    <Edit2 size={18} />
                                                                </button>
                                                                <button onClick={() => removeSupplier(sup.name)} className="text-red-600 hover:text-red-800" title="Delete">
                                                                    <Trash2 size={18} />
                                                                </button>
                                                            </div>
                                                        )}
                                                    </div>
                                                </div>
                                            );
                                        })}
                                    </div>
                                    <button onClick={saveSuppliers} disabled={isSaving} className="px-6 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold disabled:opacity-50">{isSaving ? 'Saving...' : 'Save'}</button>
                                    <div className="mt-4 p-3 bg-blue-50 rounded-lg text-sm text-blue-800">
                                        💡 <strong>Tip:</strong> Click the pencil icon to edit supplier names. All price data will update automatically.
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                );
            }

            if (screen === 'users') {
                return (
                    <div className="min-h-screen bg-gray-50">
                        <div className="bg-white shadow border-b">
                            <div className="max-w-7xl mx-auto px-4 py-4">
                                <h1 className="text-2xl font-bold">Users</h1>
                            </div>
                        </div>
                        <div className="max-w-7xl mx-auto px-4 py-6">
                            <button onClick={() => setScreen('dashboard')} className="px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg mb-6">Back</button>
                            <div className="bg-white rounded-xl shadow overflow-hidden">
                                <table className="w-full">
                                    <thead className="bg-gray-50 border-b-2 border-red-600">
                                        <tr>
                                            <th className="px-6 py-3 text-left text-xs font-medium uppercase">Name</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium uppercase">Username</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium uppercase">Role</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium uppercase">Created</th>
                                        </tr>
                                    </thead>
                                    <tbody className="divide-y">
                                        {users.map(u => (
                                            <tr key={u.id} className="hover:bg-red-50">
                                                <td className="px-6 py-4 text-sm font-medium">{u.name}</td>
                                                <td className="px-6 py-4 text-sm">{u.username}</td>
                                                <td className="px-6 py-4 text-sm">
                                                    <span className={`px-2 py-1 rounded-full text-xs font-semibold ${u.role === 'admin' ? 'bg-red-100 text-red-700' : 'bg-gray-100 text-gray-700'}`}>
                                                        {u.role}
                                                    </span>
                                                </td>
                                                <td className="px-6 py-4 text-sm">{new Date(u.createdAt).toLocaleDateString()}</td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                );
            }

            return null;
        };

        // Render the app
        ReactDOM.render(<BuybackSystem />, document.getElementById('root'));
    </script>
</body>
</html>
